__NUXT_JSONP__("/tag/github-actions", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){return {data:[{tag:{_id:i,_sys:{raw:{createdAt:b,updatedAt:b,firstPublishedAt:b,publishedAt:b},createdAt:b,updatedAt:b},name:j,slug:k,image:{_id:l,altText:a,description:a,fileName:m,fileSize:n,fileType:e,height:c,metadata:{},src:o,title:a,width:c}},posts:[{_id:"633f007e2c3aa4b59313ccd1",_sys:{raw:{createdAt:"2022-10-06T16:21:18.615Z",updatedAt:f,firstPublishedAt:p,publishedAt:f},createdAt:p,updatedAt:f},title:"FirebaseのCIデプロイが突然落ちるようになった",slug:"firebase-github-actions-error",description:"本サイトの環境はFirebaseにデプロイしており、GitHub Actionsで自動でデプロイするようにしていますが、突然エラーが発生して落ちるようになりました。",meta:{title:"FirebaseのCIデプロイが突然落散るようになった",description:a,ogImage:null},body:"\u003Ch2\u003Eエラー発生\u003C\u002Fh2\u003E\n\u003Cp\u003E本サイトの環境はFirebaseにデプロイしており、GitHub Actionsで自動でデプロイするようにしていますが、突然エラーが発生して落ちるようになりました。\u003C\u002Fp\u003E\n\u003Ch2\u003Eエラー内容\u003C\u002Fh2\u003E\n\u003Cp\u003Eエラー内容は以下です。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-log\"\u003EError: Failed to list functions for *******\n\nThe process '\u002Fusr\u002Flocal\u002Fbin\u002Fnpx' failed with exit code 1\nError: The process '\u002Fusr\u002Flocal\u002Fbin\u002Fnpx' failed with exit code 1\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eさすがにさっきのだけじゃあ何もわからないので少し探してみる。\u003C\u002Fp\u003E\n\u003Ch3\u003Eエラー1\u003C\u002Fh3\u003E\n\u003Cp\u003E調べると以下のエラーが発生していました。\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-log\"\u003E[2022-10-06T16:20:32.871Z] [functions] HTTP Error: 403, Cloud Functions API has not been used in project 700***** before or it is disabled. Enable it by visiting \n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Eエラーの少し前になんかそれっぽいことが書いてありますね。「Cloud Functions API」とやらが有効化されていないから有効化しろとのことです。\u003C\u002Fp\u003E\n\u003Cp\u003Eとりあえず、GCPにログインして、対象のプロジェクトで「Cloud Functions API」を有効化します。\u003C\u002Fp\u003E\n\u003Ch3\u003Eエラー2\u003C\u002Fh3\u003E\n\u003Cp\u003E先ほどのエラーはなくなりましたが、今度は以下のようなエラーが発生。（もともとあったかもしんない）\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-log\"\u003EError: HTTP Error: 403, Permission 'cloudfunctions.functions.list' denied on 'projects\u002F**********\u002Flocations\u002F-\u002Ffunctions'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Efirebaseのバグっぽい？調べると以下のIssueにあたりました。\u003Cbr\u003E\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FFirebaseExtended\u002Faction-hosting-deploy\u002Fissues\u002F203\"\u003Ehttps:\u002F\u002Fgithub.com\u002FFirebaseExtended\u002Faction-hosting-deploy\u002Fissues\u002F203\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E一番評価がありそうな解決策を試してみます。\u003Cbr\u003E\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FFirebaseExtended\u002Faction-hosting-deploy\u002Fissues\u002F203#issuecomment-1127732956\"\u003Ehttps:\u002F\u002Fgithub.com\u002FFirebaseExtended\u002Faction-hosting-deploy\u002Fissues\u002F203#issuecomment-1127732956\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E方法は以下の通りです\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E「IAMと管理 &gt; IAM」に移動して\u003Ccode\u003Egithub-actions\u003C\u002Fcode\u003Eから始まるアカウントを探す\u003C\u002Fli\u003E\n\u003Cli\u003E鉛筆マークで「別のロールを追加」から、\u003Ccode\u003ECloud Functions 閲覧者\u003C\u002Fcode\u003Eを追加\u003C\u002Fli\u003E\n\u003Cli\u003E正しいプロジェクトにいるか念のために確認\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E保存してGithubActionsを再実行したところ、うまく動作しました。\u003C\u002Fp\u003E\n\u003Ch2\u003E解決策・まとめ\u003C\u002Fh2\u003E\n\u003Cp\u003Eどうやら、GCP関連の権限不足だった模様です。\u003Cbr\u003E\nどうしていきなり発生したのかはわかりません。本日（2022\u002F10\u002F6）にfirebaseから規約変更などのメールはありましたがそれが原因とは思えません。（GithubのIssueは数か月前のもの）\u003Cbr\u003E\n利用からちょうど３か月経とうかというところなので、無料期間外だからでしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003Eまぁ、よくわからんけど解決したからヨシ！\u003C\u002Fp\u003E\n\u003Cp\u003E2022\u002F10\u002F7 追記\u003Cbr\u003E\nIssueを追ってみたら、昨日あたりからこのエラーが発生したようです。\u003Cbr\u003E\n具体的な原因についてはわかりませんでした。\u003C\u002Fp\u003E\n\u003Cp\u003E今回の問題は、以下の二つの操作で解決できました。\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003ECloud Functions API\u003C\u002Fcode\u003Eの有効化\u003C\u002Fli\u003E\n\u003Cli\u003Eアカウントのロール追加\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",image:{_id:q,altText:a,description:a,fileName:r,fileSize:s,fileType:e,height:t,metadata:{},src:u,title:a,width:c},author:{_id:"61a7359d8131ac001847fbb4",_sys:{raw:{createdAt:g,updatedAt:h,firstPublishedAt:g,publishedAt:h},createdAt:g,updatedAt:h},name:v,slug:v,biography:"\u003Cp\u003EWebエンジニアです。\u003C\u002Fp\u003E\u003Cp\u003Eよろしくお願いします。\u003C\u002Fp\u003E",image:{_id:"63de027516bdb9179566c9ba",altText:a,description:a,fileName:"IMG_20191028_124950_2.jpg",fileSize:611177,fileType:"image\u002Fjpeg",height:w,metadata:{},src:"https:\u002F\u002Fik.imagekit.io\u002Fmasahikoproject\u002F7e195ec3-1779-4c5f-9f0e-1d0bcf7d6c34\u002FIMG_20191028_124950_2.jpg",title:a,width:w}},tags:[{_id:"633f0f082c3aa4b593186c2d",_sys:{raw:{createdAt:d,updatedAt:d,firstPublishedAt:d,publishedAt:d},createdAt:d,updatedAt:d},name:"Firebase",slug:"firebase",image:{_id:q,altText:a,description:a,fileName:r,fileSize:s,fileType:e,height:t,metadata:{},src:u,title:a,width:c}},{_id:i,_sys:{raw:{createdAt:b,updatedAt:b,firstPublishedAt:b,publishedAt:b},createdAt:b,updatedAt:b},name:j,slug:k,image:{_id:l,altText:a,description:a,fileName:m,fileSize:n,fileType:e,height:c,metadata:{},src:o,title:a,width:c}}]}],notes:[]}],fetch:{},mutations:void 0}}("","2022-10-06T17:23:50.965Z",256,"2022-10-06T17:23:20.446Z","image\u002Fsvg+xml","2022-10-07T07:46:38.074Z","2021-12-01T08:43:09.433Z","2023-02-04T07:00:38.318Z","633f0f262c3aa4b593186ec4","Github Actions","github-actions","633f0f1e2c3aa4b593186e62","github-actions.svg",3237,"https:\u002F\u002Fik.imagekit.io\u002Fmasahikoproject\u002F34b7fbad-72d9-4a2a-b7b4-7d3bfd1bc892\u002Fgithub-actions.svg","2022-10-06T17:08:31.771Z","633f00f52c3aa4b593141c01","firebase.svg",2608,351,"https:\u002F\u002Fik.imagekit.io\u002Fmasahikoproject\u002F819f9f03-7710-4edc-b936-2507fe7e3a9a\u002Ffirebase.svg","masa",2689)));